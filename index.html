<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Xran Testnet Ultimate Game</title>
<style>
body { font-family: 'Segoe UI', sans-serif; background:#f0f2f5; text-align:center; margin:0; padding:0;}
#game-container { max-width:700px; margin:30px auto; background:white; padding:25px; border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,0.2);}
h1 { margin-bottom:10px; }
button { margin:5px; padding:10px 20px; font-size:16px; cursor:pointer; border:none; border-radius:8px; background:#007bff; color:white; transition:0.2s; }
button:hover { background:#0056b3; transform:scale(1.05);}
#leaderboard { margin-top:25px; text-align:left; }
ol { padding-left:20px; }
.gem { width:35px; height:35px; display:inline-block; position:relative; margin:3px; cursor:pointer; transition:transform 0.2s; }
.gem img { width:100%; height:100%; }
.gem span { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:12px; font-weight:bold; color:white; pointer-events:none;}
.xp-fire { font-weight:bold; display:inline-block; transition:color 0.5s; position:relative; }
.xp-popup { position:absolute; top:-25px; left:50%; transform:translateX(-50%); font-weight:bold; font-size:16px; animation:popUp 1s forwards; }
@keyframes popUp { 0% {opacity:1; transform:translate(-50%,0);} 100% {opacity:0; transform:translate(-50,-30px);} }
li.highlight { background-color:#cce5ff; font-weight:bold; padding:3px 6px; border-radius:5px; margin-bottom:3px; }
.particle { position:absolute; width:6px; height:6px; border-radius:50%; pointer-events:none; animation:particleAnim 0.8s forwards; }
@keyframes particleAnim { 0% {opacity:1; transform:translate(0,0) scale(1);} 100% {opacity:0; transform:translate(calc(var(--dx)), calc(var(--dy))) scale(0);} }
</style>
</head>
<body>
<div id="game-container">
<h1>üöÄ Xran Ultimate Mini Game</h1>
<p>XP: <span id="xp">0</span></p>
<p>tXRAN: <span id="tXran">0</span></p>
<p>Gems Left:</p>
<div id="gemsDisplay"></div>

<button id="clickBtn">CLICK</button>
<button id="dailyBtn">Daily Check-in</button>
<button id="faucetWebBtn">Claim Faucet Website</button>
<button id="faucetDiscordBtn">Claim Faucet Discord</button>
<button id="buyGemsBtn">Buy 5 Gems (tXRAN)</button>

<div id="leaderboard">
<h2>üèÜ Leaderboard (Global)</h2>
<ol id="leaderboardList"></ol>
</div>
</div>

<!-- Audio -->
<audio id="clickSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>
<audio id="xpSound" src="https://freesound.org/data/previews/320/320654_5260871-lq.mp3"></audio>

<script>
// Persistent Data
let gems=parseInt(localStorage.getItem("gems"))||60;
let xp=parseInt(localStorage.getItem("xp"))||0;
let tXran=parseInt(localStorage.getItem("tXran"))||0;
let dailyClaimed=localStorage.getItem("dailyClaimed")==="true";
let gemsPurchased=parseInt(localStorage.getItem("gemsPurchased"))||0;
const playerName=getPlayerId();
const gemsDisplay=document.getElementById("gemsDisplay");
const xpDisplay=document.getElementById("xp");
const tXranDisplay=document.getElementById("tXran");
const clickBtn=document.getElementById("clickBtn");
const dailyBtn=document.getElementById("dailyBtn");
const faucetWebBtn=document.getElementById("faucetWebBtn");
const faucetDiscordBtn=document.getElementById("faucetDiscordBtn");
const buyGemsBtn=document.getElementById("buyGemsBtn");
const leaderboardList=document.getElementById("leaderboardList");
const clickSound=document.getElementById("clickSound");
const xpSound=document.getElementById("xpSound");
let leaderboard=JSON.parse(localStorage.getItem("leaderboard"))||{};

// Helpers
function getPlayerId(){let id=localStorage.getItem("playerId"); if(!id){id=prompt("Enter your player name","Player1"); localStorage.setItem("playerId",id);} return id;}
function getXPColor(xp){if(xp<50)return"orange"; if(xp<100)return"orangered"; return"red";}
function showXPPopup(amount){
    xpSound.play();
    const popup=document.createElement("span");
    popup.className="xp-popup";
    popup.textContent=`+${amount} XP`;
    xpDisplay.parentNode.appendChild(popup);
    setTimeout(()=>popup.remove(),1000);
}
function spawnParticle(x,y){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=x+"px"; p.style.top=y+"px";
    const angle=Math.random()*2*Math.PI;
    const dist=Math.random()*50+20;
    p.style.setProperty('--dx', `${dist*Math.cos(angle)}px`);
    p.style.setProperty('--dy', `${-Math.abs(dist*Math.sin(angle))}px`);
    p.style.background="gold";
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),800);
}
function updateXPDisplay(){xpDisplay.innerHTML=`<span class="xp-fire" style="color:${getXPColor(xp)}">üî• ${xp}</span>`;}
function updateGemsDisplay(){
    let html=""; for(let i=0;i<gems;i++){html+=`<div class="gem"><img src="https://cdn-icons-png.flaticon.com/512/616/616408.png"/><span>tXRAN</span></div>`;}
    gemsDisplay.innerHTML=html;
    document.querySelectorAll('.gem').forEach((gem,i)=>{
        gem.onclick=()=>{
            gem.style.transform="scale(1.3)";
            clickSound.play();
            setTimeout(()=>gem.style.transform="scale(1)",200);
            spawnParticle(gem.getBoundingClientRect().left+15, gem.getBoundingClientRect().top+15);
        };
    });
}
function updateLeaderboard(){
    leaderboard[playerName]={xp:xp};
    localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
    let entries=Object.entries(leaderboard).map(([name,data])=>({name, xp:data.xp}));
    entries.sort((a,b)=>b.xp-a.xp);
    leaderboardList.innerHTML="";
    entries.forEach(entry=>{
        const li=document.createElement("li");
        li.textContent=entry.name+": "+entry.xp+" XP";
        if(entry.name===playerName) li.classList.add("highlight");
        leaderboardList.appendChild(li);
    });
}
function updateAllDisplays(){updateXPDisplay(); tXranDisplay.textContent=tXran; updateGemsDisplay(); updateLeaderboard(); updateBuyGemsButton();}
function updateBuyGemsButton(){buyGemsBtn.disabled=(gems>0 || gemsPurchased>=3 || tXran<5);}
updateAllDisplays();

// Mini-Game Click
clickBtn.onclick=()=>{
    if(gems>0){
        gems--; let reward=Math.floor(Math.random()*8)+3; xp+=reward; showXPPopup(reward);
        localStorage.setItem("xp",xp); localStorage.setItem("gems",gems);
        updateAllDisplays();
    }else alert("No more gems! Buy Gems to continue.");
};

// Daily
dailyBtn.onclick=()=>{
    if(!dailyClaimed){ xp+=20; tXran+=1; dailyClaimed=true;
        localStorage.setItem("xp",xp); localStorage.setItem("tXran",tXran); localStorage.setItem("dailyClaimed",true);
        showXPPopup(20); alert("Daily claimed! +20 XP, +1 tXRAN"); updateAllDisplays();
    } else alert("Already claimed today!");
};

// Faucet
faucetWebBtn.onclick=()=>{tXran+=1; localStorage.setItem("tXran",tXran); alert("Faucet Website claimed! +1 tXRAN"); updateAllDisplays();}
faucetDiscordBtn.onclick=()=>{tXran+=1; localStorage.setItem("tXran",tXran); alert("Faucet Discord claimed! +1 tXRAN"); updateAllDisplays();}

// Buy Gems
buyGemsBtn.onclick=()=>{
    const price=5;
    if(tXran>=price && gemsPurchased<3){ tXran-=price; gems+=5; gemsPurchased++; localStorage.setItem("tXran",tXran); localStorage.setItem("gems",gems); localStorage.setItem("gemsPurchased",gemsPurchased); alert("Bought 5 Gems! Used "+price+" tXRAN. Purchase "+gemsPurchased+"/3"); updateAllDisplays();}
    else if(gemsPurchased>=3) alert("Maximum 3 purchases reached!"); else alert("Not enough tXRAN!");
};

// Daily reset
const lastClaim=localStorage.getItem("lastClaimTime"); const now=new Date().getTime();
if(!lastClaim || now-lastClaim>24*60*60*1000){dailyClaimed=false; localStorage.setItem("dailyClaimed",false); localStorage.setItem("lastClaimTime",now);}
</script>
</body>
</html>
